/*
 * Copyright (c) 2022 The ZMK Contributors
 *
 * SPDX-License-Identifier: MIT
 */

#include <dt-bindings/zmk/matrix_transform.h>
#include <zmk/physical_layout.h> // Add include for physical layout

/ {
    chosen {
		zmk,physical-layout = &default_layout;
		zmk,studio-rpc-uart = &uart1;
    };

    default_transform: keymap_transform_0 {
        compatible = "zmk,matrix-transform";
        columns = <10>;
        rows = <5>;
//      | SW00  | SW01  | SW02  | SW03  | SW04  |  | SW04  | SW03  | SW02  | SW01  | SW00  |
//             | SW05  | SW06  | SW07  | SW08  | SW09  |  | SW09  | SW08  | SW07  | SW06  | SW05  |
//             | SW10  | SW11  | SW12  | SW13  | SW14  |  | SW14  | SW13  | SW12  | SW11  | SW10  |
//      | SW20 | SW15  | SW16  | SW17  | SW18  | SW19  |  | SW19  | SW18  | SW17  | SW16  | SW15  | SW20  |
//                             | SW21  | SW22  | SW23  |  | SW23  | SW22  | SW21  |
        map = <
                RC(0,0) RC(0,1) RC(0,2) RC(0,3) RC(0,4)    RC(0,5) RC(0,6) RC(0,7) RC(0,8) RC(0,9)
                RC(1,0) RC(1,1) RC(1,2) RC(1,3) RC(1,4)    RC(1,5) RC(1,6) RC(1,7) RC(1,8) RC(1,9)
        RC(4,1) RC(2,0) RC(2,1) RC(2,2) RC(2,3) RC(2,4)    RC(2,5) RC(2,6) RC(2,7) RC(2,8) RC(2,9) RC(4,8)
        RC(4,0) RC(3,0) RC(3,1) RC(3,2) RC(3,3) RC(3,4)    RC(3,5) RC(3,6) RC(3,7) RC(3,8) RC(3,9) RC(4,9)
                                RC(4,2) RC(4,3) RC(4,4)    RC(4,5) RC(4,6) RC(4,7)
        >;
    };


    kscan0: kscan_0 {
        compatible = "zmk,kscan-gpio-matrix";
        label = "KSCAN";

        diode-direction = "col2row";
        row-gpios
            = <&xiao_d 6 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&xiao_d 0 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&xiao_d 1 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&xiao_d 2 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            , <&xiao_d 3 (GPIO_ACTIVE_HIGH | GPIO_PULL_DOWN)>
            ;
    };

    default_layout: default_layout {
		compatible = "zmk,physical-layout";
		display-name = "Default";

		transform = <&default_transform>;
		kscan = <&kscan0>;

		keys = <
            K(100  0   100 100) K(200  0   100 100) K(300  0   100 100) K(400  0   100 100) K(500  0   100 100)   K(700  0   100 100) K(800  0   100 100) K(900  0   100 100) K(1000 0   100 100) K(1100 0   100 100) // Row 0 (RC0,0 to RC0,9)
            K(100  100 100 100) K(200  100 100 100) K(300  100 100 100) K(400  100 100 100) K(500  100 100 100)   K(700  100 100 100) K(800  100 100 100) K(900  100 100 100) K(1000 100 100 100) K(1100 100 100 100) // Row 1 (RC1,0 to RC1,9)
            K(0    200 100 100) K(100  200 100 100) K(200  200 100 100) K(300  200 100 100) K(400  200 100 100) K(500  200 100 100)   K(700  200 100 100) K(800  200 100 100) K(900  200 100 100) K(1000 200 100 100) K(1100 200 100 100) K(1200 200 100 100) // Row 2 + Outer Col (RC4,1 + RC2,0-9 + RC4,8)
            K(0    300 100 100) K(100  300 100 100) K(200  300 100 100) K(300  300 100 100) K(400  300 100 100) K(500  300 100 100)   K(700  300 100 100) K(800  300 100 100) K(900  300 100 100) K(1000 300 100 100) K(1100 300 100 100) K(1200 300 100 100) // Row 3 + Outer Col (RC4,0 + RC3,0-9 + RC4,9)
            /* Thumb Cluster - Assuming y=400 */                                           K(300  400 100 100) K(400  400 100 100) K(500  400 100 100)   K(700  400 100 100) K(800  400 100 100) K(900  400 100 100)                          // Row 4 (RC4,2 to RC4,7)
        >;
	};
};